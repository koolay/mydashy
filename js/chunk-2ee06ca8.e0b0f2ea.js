(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ee06ca8"],{"1c8e":function(t,e,s){"use strict";s("99af"),s("e9c4"),s("d3b7");var n=s("bc3a"),i=s.n(n),o=s("d445"),r=s("3136"),a=s("5cc6"),u={props:{options:{type:Object,default:{}}},data:function(){return{progress:new o["a"]({color:"var(--progress-bar)"}),overrideProxyChoice:!1,overrideUpdateInterval:null,disableLoader:!1,updater:null,defaultTimeout:5e4}},mounted:function(){this.fetchData(),this.updateInterval&&(this.continuousUpdates(),this.disableLoader=!0)},beforeDestroy:function(){this.updater&&clearInterval(this.updater)},computed:{proxyReqEndpoint:function(){var t=Object({NODE_ENV:"production",VUE_APP_VERSION:"2.1.0",BASE_URL:"/"}).VUE_APP_DOMAIN||window.location.origin;return"".concat(t).concat(a["serviceEndpoints"].corsProxy)},useProxy:function(){return this.options.useProxy||this.overrideProxyChoice},updateInterval:function(){var t=this.options.updateInterval;return null===t&&this.overrideUpdateInterval?1e3*this.overrideUpdateInterval:t?"boolean"===typeof t?3e4:"number"===typeof t&&t>=2&&t<=7200?1e3*t:0:0}},methods:{update:function(){this.startLoading(),this.fetchData()},continuousUpdates:function(){var t=this;this.updater=setInterval((function(){t.update()}),this.updateInterval)},error:function(t,e){Object(r["e"])(t,e),this.$emit("error",t)},startLoading:function(){this.disableLoader||(this.$emit("loading",!0),this.progress.start())},finishLoading:function(){var t=this;this.$emit("loading",!1),setTimeout((function(){t.progress.end()}),500)},fetchData:function(){this.finishLoading()},tooltip:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{content:t,html:e,trigger:"hover focus",delay:250}},makeRequest:function(t,e,s,n){var o=this,r=s||"GET",a=this.useProxy?this.proxyReqEndpoint:t,u=JSON.stringify(n||{}),l=e||null,c=this.useProxy?{"Target-URL":t,CustomHeaders:JSON.stringify(l)}:l,d=this.options.timeout||this.defaultTimeout,f={method:r,url:a,headers:c,data:u,timeout:d};return new Promise((function(t,e){i.a.request(f).then((function(e){!1===e.data.success&&o.error("Proxy returned error from target server",e.data.message),t(e.data)})).catch((function(t){o.error("Unable to fetch data",t),e(t)})).finally((function(){o.finishLoading()}))}))}}};e["a"]=u},"1c95":function(t,e,s){"use strict";s("24a3")},"24a3":function(t,e,s){},"5d62":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tfl-status"},[t.lineStatuses?[t._l(t.filterLines,(function(e){return s("div",{key:e.index,staticClass:"line-row"},[s("p",{staticClass:"row name"},[t._v(t._s(e.line))]),s("p",{class:"row status "+t.getStatusColor(e.statusCode)},[t._v(t._s(e.status))]),e.disruption?s("p",{staticClass:"row disruption"},[t._v(t._s(t._f("format")(e.disruption)))]):t._e()])})),t.showAll?t._e():s("div",{staticClass:"line-row"},[s("p",{staticClass:"row all-other"},[t._v(" "+t._s(t.filterLines.length>0?t.$t("widgets.tfl-status.good-service-rest"):t.$t("widgets.tfl-status.good-service-all"))+" ")])]),s("p",{staticClass:"more-details-btn",on:{click:t.toggleAllLines}},[t._v(" "+t._s(t.showAll?t.$t("widgets.general.show-less"):t.$t("widgets.general.show-more"))+" ")])]:t._e()],2)},i=[],o=(s("4de4"),s("d3b7"),s("ac1f"),s("1276"),s("159b"),s("b0c0"),s("d81d"),s("caad"),s("2532"),s("4e82"),s("bc3a")),r=s.n(o),a=s("1c8e"),u=s("5cc6"),l={mixins:[a["a"]],data:function(){return{lineStatuses:null,showAll:!1}},computed:{filterLines:function(){return this.showAll?this.lineStatuses:this.lineStatuses.filter((function(t){return 10!==t.statusCode}))}},filters:{format:function(t){var e=t.split(":");return e.length>1?e[1]:e[0]}},methods:{fetchData:function(){var t=this;r.a.get(u["widgetApiEndpoints"].tflStatus).then((function(e){t.lineStatuses=t.processData(e.data)})).catch((function(){t.error("Unable to fetch data from TFL API")})).finally((function(){t.finishLoading()}))},processData:function(t){var e=[];return t.forEach((function(t,s){e.push({index:s,line:t.name,statusCode:t.lineStatuses[0].statusSeverity,status:t.lineStatuses[0].statusSeverityDescription,disruption:t.lineStatuses[0].reason})})),this.options.sortAlphabetically||(e=this.sortByStatusCode(e)),this.options.linesToShow&&Array.isArray(this.options.linesToShow)&&(e=this.filterByLineName(e,this.options.linesToShow)),e},getStatusColor:function(t){return 20===t?"dark":0===t?"info":t<=6?"red":t<=9?"orange":"green"},filterByLineName:function(t,e){var s=e.map((function(t){return t.toLowerCase()})),n=t.filter((function(t){return s.includes(t.line.toLowerCase())}));return n.length<1?(this.error("No TFL lines match your filter"),t):n},sortByStatusCode:function(t){return t.reverse().sort((function(t,e){return t.statusCode>e.statusCode?1:-1}))},toggleAllLines:function(){this.showAll=!this.showAll}}},c=l,d=(s("1c95"),s("2877")),f=Object(d["a"])(c,n,i,!1,null,"06c1769f",null);e["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2ee06ca8.e0b0f2ea.js.map